package ru.eda.plgn.bizgen.generators.impl

import ru.eda.plgn.bizgen.generators.Generator
import ru.eda.plgn.bizgen.generators.GeneratorResult
import ru.eda.plgn.bizgen.generators.GeneratorResultWithEscape
import ru.eda.plgn.bizgen.generators.impl.OrgRuNameGenerator.OrganizationRuNameGeneratorInner.generateOrganizationName
import kotlin.random.Random

/**
 * Генератор наименований организаций на русском языке.
 *
 * @author Dmitry_Emelyanenko
 */
class OrgRuNameGenerator : Generator<String> {
  override fun generate(): GeneratorResult<String> = GeneratorResultWithEscape(data = generateOrganizationName())


  private object OrganizationRuNameGeneratorInner {
    private val companyTypes = listOf("ООО", "ИП", "АО", "ФКП")

    private val firstWords = listOf(
      // Основные промышленные и технологические
      "Глобал", "Техно", "Рос", "Металл", "Строй", "Транс", "Нефть", "Газ",
      "Агро", "Мед", "Фарм", "Телеком", "Инвест", "Финанс", "Энерго", "Прогресс",
      "Мега", "Космос", "Альфа", "Омега", "Дельта", "Сигма", "Вектор", "Квант",
      "Сиб", "Даль", "Урал", "Север", "Юг", "Восток", "Запад", "Центр",
      "Науч", "Тех", "Пром", "Хим", "Эко", "Био", "Нано", "Кибер",

      // Географические и региональные
      "Москва", "Петербург", "Сибирь", "Байкал", "Волга", "Дон", "Амур", "Алтай",
      "Камчатка", "Сахалин", "Крым", "Кавказ", "Черноземье", "Нева", "Обь", "Енисей",
      "Лена", "Ангара", "Балтика", "Арктик", "Таймыр", "Приморье", "Забайкалье", "Курск",
      "Тверь", "Рязань", "Владимир", "Ярославль", "Кострома", "Вологда", "Псков", "Новгород",

      // Технологии и инновации
      "Робот", "АйТи", "Код", "Софт", "Хард", "Чип", "Драйв", "Смарт",
      "Дижитал", "Вирту", "Клауд", "Нейро", "Крипто", "Блокчейн", "Токен", "Айпи",
      "Датчик", "Сенсор", "Микро", "Опто", "Лазер", "Плазмо", "Квантум", "Фотон",

      // Строительство и недвижимость
      "Дом", "Квартал", "Жил", "Комфорт", "Фасад", "Фундамент", "Кровля", "Бетон",
      "Кирпич", "Стекло", "Метро", "Мост", "Тоннель", "Высот", "Архитек", "Проект",

      // Транспорт и логистика
      "Авиа", "Авто", "Желдор", "Речфлот", "Морфлот", "Транзит", "Экспресс", "Карго",
      "Фрахт", "Контейнер", "Логист", "Транса", "Аэро", "Такси", "Бус", "Троллей",

      // Финансы и бизнес
      "Капитал", "Актив", "Траст", "Кредит", "Депозит", "Лизинг", "Факторинг", "Аудит",
      "Консалт", "Маркет", "Бизнес", "Трейд", "Импэкс", "Экспо", "Форум", "Клуб",

      // Наука и образование
      "Академи", "Универ", "Колледж", "Лицей", "Институт", "Лаборатор", "Исслед", "Эксперимент",
      "Знание", "Прогресс", "Интеллект", "Гений", "Талант", "Олимп", "Эрудит", "Курс",

      // Медицина и фармацевтика
      "Медика", "Клиника", "Диагност", "Терапия", "Стомат", "Офтальмо", "Кардио", "Нейро",
      "Фарма", "Вита", "Генетик", "Иммуно", "Био", "Гигиена", "Санаторий", "Спа",

      // Торговля и услуги
      "Торг", "Маркет", "Супер", "Гипер", "Мега", "Универсам", "Гастроном", "Продукт",
      "Сервис", "Центр", "Плюс", "Экстра", "Премиум", "Люкс", "Гранд", "Элит",

      // Природные ресурсы и экология
      "Лес", "Вода", "Воздух", "Земля", "Плодородие", "Эко", "Ресурс", "Гео",
      "Нефте", "Газо", "Уголь", "Руда", "Металлург", "Хим", "Полимер", "Энерг",

      // Культура и искусство
      "Арт", "Культ", "Театр", "Кино", "Музей", "Галерея", "Выставка", "Фестиваль",
      "Концерт", "Филармония", "Оркестр", "Хор", "Балет", "Опера", "Драма", "Цирк"
    )

    private val secondWords = listOf(
      "Сервис", "Групп", "Холдинг", "Трейд", "Лизинг", "Банк", "Капитал", "Ресурс",
      "Снаб", "Торг", "Пром", "Тех", "Индустрия", "Системы", "Технологии", "Решения",
      "Консалтинг", "Менеджмент", "Развитие", "Партнеры", "Центр", "Альянс", "Траст",
      "Корпорация", "Компани", "Концерн", "Синдикат", "Трест", "Ассоциация", "Фонд",
      "Венчур", "Диджитал", "Инновации", "Логистика", "Маркет", "Недвижимость", "Ойл",
      "Проект", "Строй", "Транзит", "Универсал", "Фабрика", "Хайтек", "Центр", "Эксперт",
      "Юнион", "Ярд", "Лаб", "Медиа", "Нетворк", "Онлайн", "Премиум", "Квалити"
    )

    private val longSuffixes = listOf(
      " имени академика Петрова-Соколова",
      " Северо-Западного федерального округа",
      " по производству высокотехнологичного оборудования",
      " для нефтегазовой промышленности и энергетики",
      " в сфере информационных технологий и цифровой трансформации",
      " городского округа Краснознаменск Московской области",
      " при Правительстве Российской Федерации",
      " по разработке инновационных решений в области искусственного интеллекта",
      " и дочерние предприятия группы компаний 'Восток-Запад'",
      " (бывшее предприятие 'Прогресс-Электронмаш')"
    )

    fun generateOrganizationName(): String {
      val random = Random.Default
      val type = companyTypes.random()
      val useTwoWords = random.nextBoolean()

      val baseName = buildString {
        append(firstWords.random())
        if (useTwoWords) {
          append(secondWords.random())
        }
      }

      // 30% chance to add long suffix
      val fullName = if (random.nextDouble() < 0.3) {
        val suffix = longSuffixes.random()
        // Ensure total length doesn't exceed 255 chars
        if (type.length + 1 + baseName.length + suffix.length <= 255) {
          "$type $baseName$suffix"
        } else {
          // If too long, truncate suffix
          val maxSuffixLength = 255 - (type.length + 1 + baseName.length)
          "$type $baseName${suffix.take(maxSuffixLength)}"
        }
      } else {
        "$type $baseName"
      }

      return fullName
    }
  }
}